{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/home/felix/Felix/Hack/hack/screens/auth/Verify.js\";\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { Title, Subheading, TextInput } from \"react-native-paper\";\nimport { CodeField, Cursor, useBlurOnFulfill, useClearByFocusCell } from 'react-native-confirmation-code-field';\nimport { Button, List, Divider } from \"react-native-paper\";\nimport * as authActions from \"../../store/actions/auth\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport * as messageActions from \"../../store/actions/messages\";\nvar CELL_COUNT = 6;\nvar RESEND_OTP_TIME_LIMIT = 90;\n\nvar Verify = function Verify(_ref) {\n  var navigation = _ref.navigation;\n  var dispatch = useDispatch();\n  var phone = useSelector(function (state) {\n    return state.auth.phone;\n  });\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      value = _useState2[0],\n      setValue = _useState2[1];\n\n  var resendOtpTimerInterval;\n\n  var _useState3 = useState(RESEND_OTP_TIME_LIMIT),\n      _useState4 = _slicedToArray(_useState3, 2),\n      resendButtonDisabledTime = _useState4[0],\n      setResendButtonDisabledTime = _useState4[1];\n\n  useEffect(function () {\n    navigation.addListener('beforeRemove', function (e) {\n      e.preventDefault();\n    });\n  }, [navigation]);\n\n  var startResendOtpTimer = function startResendOtpTimer() {\n    if (resendOtpTimerInterval) {\n      clearInterval(resendOtpTimerInterval);\n    }\n\n    resendOtpTimerInterval = setInterval(function () {\n      if (resendButtonDisabledTime <= 0) {\n        clearInterval(resendOtpTimerInterval);\n      } else {\n        setResendButtonDisabledTime(resendButtonDisabledTime - 1);\n      }\n    }, 1000);\n  };\n\n  var onResendOtpButtonPress = function onResendOtpButtonPress() {\n    setValue('');\n    setResendButtonDisabledTime(RESEND_OTP_TIME_LIMIT);\n    startResendOtpTimer();\n    console.log('todo: Resend OTP');\n  };\n\n  var ref = useBlurOnFulfill({\n    value: value,\n    cellCount: CELL_COUNT\n  });\n\n  var _useClearByFocusCell = useClearByFocusCell({\n    value: value,\n    setValue: setValue\n  }),\n      _useClearByFocusCell2 = _slicedToArray(_useClearByFocusCell, 2),\n      props = _useClearByFocusCell2[0],\n      getCellOnLayoutHandler = _useClearByFocusCell2[1];\n\n  useEffect(function () {\n    startResendOtpTimer();\n    return function () {\n      if (resendOtpTimerInterval) {\n        clearInterval(resendOtpTimerInterval);\n      }\n    };\n  }, [resendButtonDisabledTime]);\n\n  var onSubmitHandler = function onSubmitHandler() {\n    return _regeneratorRuntime.async(function onSubmitHandler$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!(value.length < 6)) {\n              _context.next = 2;\n              break;\n            }\n\n            return _context.abrupt(\"return\");\n\n          case 2:\n            _context.prev = 2;\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(dispatch(authActions.verifyOtp(value, phone)));\n\n          case 5:\n            _context.next = 11;\n            break;\n\n          case 7:\n            _context.prev = 7;\n            _context.t0 = _context[\"catch\"](2);\n            console.log(_context.t0);\n            dispatch(messageActions.setMessage(_context.t0.message, \"error\"));\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[2, 7]], Promise);\n  };\n\n  var onChangeTextHandler = function onChangeTextHandler(inputValue) {\n    if (!/^\\d*$/.test(inputValue)) {\n      return;\n    }\n\n    setValue(inputValue);\n  };\n\n  var reAuthenticate = function reAuthenticate(channel) {\n    return _regeneratorRuntime.async(function reAuthenticate$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(dispatch(authActions.authenticate(phone, channel)));\n\n          case 3:\n            _context2.next = 9;\n            break;\n\n          case 5:\n            _context2.prev = 5;\n            _context2.t0 = _context2[\"catch\"](0);\n            console.log(_context2.t0);\n            dispatch(messageActions.setMessage(_context2.t0.message, \"error\"));\n\n          case 9:\n            onResendOtpButtonPress();\n\n          case 10:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 5]], Promise);\n  };\n\n  return React.createElement(SafeAreaView, {\n    style: styles.root,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 3\n    }\n  }, React.createElement(ScrollView, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 4\n    }\n  }, React.createElement(KeyboardAvoidingView, {\n    behavior: Platform.OS === 'ios' ? \"height\" : \"padding\",\n    style: {\n      flex: 1\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    style: styles.center,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 6\n    }\n  }, React.createElement(Title, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }\n  }, \"Verify \", phone)), React.createElement(View, {\n    style: styles.sub,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 6\n    }\n  }, React.createElement(Subheading, {\n    style: {\n      textAlign: \"center\",\n      lineHeight: 17\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }\n  }, \"Waiting to verify SMS sent to \", phone)), React.createElement(View, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 6\n    }\n  }, React.createElement(CodeField, _extends({\n    ref: ref\n  }, props, {\n    value: value,\n    onChangeText: onChangeTextHandler,\n    cellCount: CELL_COUNT,\n    rootStyle: styles.codeFieldRoot,\n    keyboardType: \"number-pad\",\n    onEndEditing: onSubmitHandler,\n    textContentType: \"oneTimeCode\",\n    renderCell: function renderCell(_ref2) {\n      var index = _ref2.index,\n          symbol = _ref2.symbol,\n          isFocused = _ref2.isFocused;\n      return React.createElement(View, {\n        onLayout: getCellOnLayoutHandler(index),\n        key: index,\n        style: [styles.cellRoot, isFocused && styles.focusCell],\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 9\n        }\n      }, React.createElement(Text, {\n        style: styles.cellText,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 10\n        }\n      }, symbol || (isFocused ? React.createElement(Cursor, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 35\n        }\n      }) : null)));\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }\n  })), React.createElement(Subheading, {\n    style: {\n      alignSelf: \"center\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }\n  }, \"Enter \", CELL_COUNT, \"-digit code\"), resendButtonDisabledTime > 0 ? React.createElement(List.Item, {\n    left: function left(props) {\n      return React.createElement(List.Icon, _extends({}, props, {\n        icon: \"message-bulleted\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 34\n        }\n      }));\n    },\n    disabled: true,\n    title: \"Resend SMS\",\n    right: function right(props) {\n      return React.createElement(Text, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 135\n        }\n      }, resendButtonDisabledTime, \"s\");\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 8\n    }\n  }) : React.createElement(List.Item, {\n    left: function left(props) {\n      return React.createElement(List.Icon, _extends({}, props, {\n        icon: \"message-bulleted\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 34\n        }\n      }));\n    },\n    onPress: reAuthenticate.bind(_this, \"sms\"),\n    title: \"Resend SMS\",\n    right: function right(props) {\n      return React.createElement(Text, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 162\n        }\n      }, resendButtonDisabledTime);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 8\n    }\n  }), React.createElement(Divider, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }\n  }), React.createElement(List.Item, {\n    left: function left(props) {\n      return React.createElement(List.Icon, _extends({}, props, {\n        icon: \"phone\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 33\n        }\n      }));\n    },\n    onPress: reAuthenticate.bind(_this, \"call\"),\n    title: \"Call me\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    style: styles.button,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }\n  }, React.createElement(Button, {\n    mode: \"contained\",\n    disabled: value.length < 6 ? true : false,\n    onPress: function onPress() {\n      return onSubmitHandler();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 8\n    }\n  }, \"Submit\"))))));\n};\n\nvar styles = StyleSheet.create({\n  center: {\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    marginTop: \"10%\"\n  },\n  sub: {\n    flex: 1,\n    textAlign: \"center\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    marginTop: \"5%\",\n    flexDirection: \"column\"\n  },\n  gridPad: {\n    padding: 30\n  },\n  textMargin: {\n    margin: 3\n  },\n  inputRadius: {\n    textAlign: \"center\"\n  },\n  root: {\n    flex: 1,\n    padding: 20,\n    alignContent: 'center',\n    justifyContent: 'center'\n  },\n  title: {\n    textAlign: 'left',\n    fontSize: 20,\n    marginStart: 20,\n    fontWeight: 'bold'\n  },\n  subTitle: {\n    textAlign: 'left',\n    fontSize: 16,\n    marginStart: 20,\n    marginTop: 10\n  },\n  codeFieldRoot: {\n    marginTop: 40,\n    width: '90%',\n    marginLeft: 20,\n    marginRight: 20\n  },\n  cellRoot: {\n    width: 40,\n    height: 40,\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderBottomColor: '#ccc',\n    borderBottomWidth: 1\n  },\n  cellText: {\n    color: '#000',\n    fontSize: 28,\n    textAlign: 'center'\n  },\n  focusCell: {\n    borderBottomColor: '#007AFF',\n    borderBottomWidth: 2\n  },\n  button: {\n    marginTop: 20,\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  resendCode: {\n    color: \"blue\",\n    marginStart: 20,\n    marginTop: 40\n  },\n  resendCodeText: {\n    marginStart: 20,\n    marginTop: 40\n  },\n  resendCodeContainer: {\n    flexDirection: 'row',\n    alignItems: 'center'\n  }\n});\nexport default Verify;","map":{"version":3,"sources":["/home/felix/Felix/Hack/hack/screens/auth/Verify.js"],"names":["React","useState","useEffect","Title","Subheading","TextInput","CodeField","Cursor","useBlurOnFulfill","useClearByFocusCell","Button","List","Divider","authActions","useDispatch","useSelector","messageActions","CELL_COUNT","RESEND_OTP_TIME_LIMIT","Verify","navigation","dispatch","phone","state","auth","value","setValue","resendOtpTimerInterval","resendButtonDisabledTime","setResendButtonDisabledTime","addListener","e","preventDefault","startResendOtpTimer","clearInterval","setInterval","onResendOtpButtonPress","console","log","ref","cellCount","props","getCellOnLayoutHandler","onSubmitHandler","length","verifyOtp","setMessage","message","onChangeTextHandler","inputValue","test","reAuthenticate","channel","authenticate","styles","root","Platform","OS","flex","center","sub","textAlign","lineHeight","codeFieldRoot","index","symbol","isFocused","cellRoot","focusCell","cellText","alignSelf","bind","button","StyleSheet","create","justifyContent","alignItems","marginTop","flexDirection","gridPad","padding","textMargin","margin","inputRadius","alignContent","title","fontSize","marginStart","fontWeight","subTitle","width","marginLeft","marginRight","height","borderBottomColor","borderBottomWidth","color","resendCode","resendCodeText","resendCodeContainer"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { View, Text, StyleSheet, SafeAreaView, ScrollView, KeyboardAvoidingView, TouchableOpacity } from \"react-native\";\nimport { Title, Subheading, TextInput } from \"react-native-paper\";\nimport { CodeField, Cursor, useBlurOnFulfill, useClearByFocusCell } from 'react-native-confirmation-code-field';\nimport { Button, List, Divider } from \"react-native-paper\";\nimport * as authActions from \"../../store/actions/auth\"\nimport { useDispatch, useSelector } from \"react-redux\"\nimport * as messageActions from '../../store/actions/messages';\n\nconst CELL_COUNT = 6;\n\nconst RESEND_OTP_TIME_LIMIT = 90;\n\nconst Verify = ({ navigation }) => {\n\tconst dispatch = useDispatch()\n\tconst phone = useSelector(state => state.auth.phone)\n\tconst [value, setValue] = useState('');\n\tlet resendOtpTimerInterval;\n\tconst [resendButtonDisabledTime, setResendButtonDisabledTime] = useState(RESEND_OTP_TIME_LIMIT,);\n\n\t//Stop backbutton\n\tuseEffect(() => {\n\t\tnavigation.addListener('beforeRemove', (e) => {\n\t\t\te.preventDefault()\n\t\t})\n\t}, [navigation])\n\n\t//to start resent otp option \n\tconst startResendOtpTimer = () => {\n\t\tif (resendOtpTimerInterval) {\n\t\t\tclearInterval(resendOtpTimerInterval);\n\t\t}\n\t\tresendOtpTimerInterval = setInterval(() => {\n\t\t\tif (resendButtonDisabledTime <= 0) {\n\t\t\t\tclearInterval(resendOtpTimerInterval);\n\t\t\t} else {\n\t\t\t\tsetResendButtonDisabledTime(resendButtonDisabledTime - 1);\n\t\t\t}\n\t\t}, 1000);\n\t};\n\t//on click of resend button \n\tconst onResendOtpButtonPress = () => {\n\t\t//clear input field\n\t\tsetValue('')\n\t\tsetResendButtonDisabledTime(RESEND_OTP_TIME_LIMIT);\n\t\tstartResendOtpTimer();\n\t\t// resend OTP Api call\n\t\t// todo \n\t\tconsole.log('todo: Resend OTP');\n\t};\n\t//declarations for input field \n\n\tconst ref = useBlurOnFulfill({ value, cellCount: CELL_COUNT });\n\tconst [props, getCellOnLayoutHandler] = useClearByFocusCell({ value, setValue, });\n\t//start timer on screen on launch \n\tuseEffect(() => {\n\t\tstartResendOtpTimer();\n\t\treturn () => {\n\t\t\tif (resendOtpTimerInterval) {\n\t\t\t\tclearInterval(resendOtpTimerInterval);\n\t\t\t}\n\t\t};\n\t}, [resendButtonDisabledTime]);\n\tconst onSubmitHandler = async () => {\n\t\tif (value.length < 6) {\n\t\t\treturn\n\t\t}\n\t\ttry {\n\t\t\tawait dispatch(authActions.verifyOtp(value, phone))\n\t\t} catch (error) {\n\t\t\tconsole.log(error)\n\t\t\tdispatch(messageActions.setMessage(error.message, \"error\"))\n\t\t}\n\t}\n\tconst onChangeTextHandler = (inputValue) => {\n\t\tif (!/^\\d*$/.test((inputValue))) {\n\t\t\treturn\n\t\t}\n\t\tsetValue(inputValue)\n\t}\n\tconst reAuthenticate = async (channel) => {\n\t\ttry {\n\t\t\tawait dispatch(authActions.authenticate(phone, channel))\n\t\t} catch (error) {\n\t\t\tconsole.log(error)\n\t\t\tdispatch(messageActions.setMessage(error.message, \"error\"))\n\t\t}\n\t\tonResendOtpButtonPress()\n\t}\n\treturn (\n\t\t<SafeAreaView style={styles.root}>\n\t\t\t<ScrollView>\n\t\t\t\t<KeyboardAvoidingView behavior={Platform.OS === 'ios' ? \"height\" : \"padding\"} style={{ flex: 1 }} >\n\t\t\t\t\t<View style={styles.center}>\n\t\t\t\t\t\t<Title>Verify {phone}</Title>\n\t\t\t\t\t</View>\n\t\t\t\t\t<View style={styles.sub}>\n\t\t\t\t\t\t<Subheading style={{ textAlign: \"center\", lineHeight: 17 }}>Waiting to verify SMS sent to {phone}</Subheading>\n\t\t\t\t\t</View>\n\t\t\t\t\t<View>\n\t\t\t\t\t\t<CodeField ref={ref}\n\t\t\t\t\t\t\t{...props} value={value}\n\t\t\t\t\t\t\tonChangeText={onChangeTextHandler}\n\t\t\t\t\t\t\tcellCount={CELL_COUNT}\n\t\t\t\t\t\t\trootStyle={styles.codeFieldRoot}\n\t\t\t\t\t\t\tkeyboardType=\"number-pad\"\n\t\t\t\t\t\t\tonEndEditing={onSubmitHandler}\n\t\t\t\t\t\t\ttextContentType=\"oneTimeCode\"\n\t\t\t\t\t\t\trenderCell={({ index, symbol, isFocused }) => (\n\t\t\t\t\t\t\t\t<View onLayout={getCellOnLayoutHandler(index)}\n\t\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\t\tstyle={[styles.cellRoot, isFocused && styles.focusCell]}>\n\t\t\t\t\t\t\t\t\t<Text style={styles.cellText}>\n\t\t\t\t\t\t\t\t\t\t{symbol || (isFocused ? <Cursor /> : null)}\n\t\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t\t</View>)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Subheading style={{ alignSelf: \"center\" }}>Enter {CELL_COUNT}-digit code</Subheading>\n\n\t\t\t\t\t\t{resendButtonDisabledTime > 0 ?\n\t\t\t\t\t\t\t<List.Item left={props => <List.Icon {...props} icon=\"message-bulleted\" />} disabled={true} title=\"Resend SMS\" right={props => <Text>{resendButtonDisabledTime}s</Text>} />\n\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t<List.Item left={props => <List.Icon {...props} icon=\"message-bulleted\" />} onPress={reAuthenticate.bind(this, \"sms\")} title=\"Resend SMS\" right={props => <Text>{resendButtonDisabledTime}</Text>} />\n\t\t\t\t\t\t}\n\t\t\t\t\t\t<Divider />\n\t\t\t\t\t\t<List.Item left={props => <List.Icon {...props} icon=\"phone\" />} onPress={reAuthenticate.bind(this, \"call\")} title=\"Call me\" />\n\n\t\t\t\t\t\t<View style={styles.button}>\n\t\t\t\t\t\t\t<Button mode=\"contained\" disabled={value.length < 6 ? true : false} onPress={() => onSubmitHandler()}>Submit</Button>\n\t\t\t\t\t\t</View>\n\t\t\t\t\t</View>\n\t\t\t\t</KeyboardAvoidingView>\n\t\t\t</ScrollView>\n\t\t</SafeAreaView>\n\t)\n}\nconst styles = StyleSheet.create({\n\tcenter: {\n\t\tjustifyContent: \"center\",\n\t\talignItems: \"center\",\n\t\tmarginTop: \"10%\"\n\t},\n\tsub: {\n\t\tflex: 1,\n\t\ttextAlign: \"center\",\n\t\tjustifyContent: \"center\",\n\t\talignItems: \"center\",\n\t\tmarginTop: \"5%\",\n\t\tflexDirection: \"column\"\n\t},\n\tgridPad: { padding: 30 },\n\ttextMargin: { margin: 3 },\n\tinputRadius: { textAlign: \"center\" },\n\troot: {\n\t\tflex: 1,\n\t\tpadding: 20,\n\t\talignContent: 'center',\n\t\tjustifyContent: 'center'\n\t},\n\ttitle: {\n\t\ttextAlign: 'left',\n\t\tfontSize: 20,\n\t\tmarginStart: 20,\n\t\tfontWeight: 'bold'\n\t},\n\tsubTitle: {\n\t\ttextAlign: 'left',\n\t\tfontSize: 16,\n\t\tmarginStart: 20,\n\t\tmarginTop: 10\n\t},\n\tcodeFieldRoot: {\n\t\tmarginTop: 40,\n\t\twidth: '90%',\n\t\tmarginLeft: 20,\n\t\tmarginRight: 20,\n\t},\n\tcellRoot: {\n\t\twidth: 40, height: 40,\n\t\tjustifyContent: 'center',\n\t\talignItems: 'center', borderBottomColor: '#ccc',\n\t\tborderBottomWidth: 1,\n\t},\n\tcellText: {\n\t\tcolor: '#000',\n\t\tfontSize: 28,\n\t\ttextAlign: 'center',\n\t},\n\tfocusCell: {\n\t\tborderBottomColor: '#007AFF',\n\t\tborderBottomWidth: 2,\n\t},\n\tbutton: {\n\t\tmarginTop: 20,\n\t\tjustifyContent: \"center\",\n\t\talignItems: \"center\"\n\t},\n\tresendCode: {\n\t\tcolor: \"blue\",\n\t\tmarginStart: 20,\n\t\tmarginTop: 40,\n\t},\n\tresendCodeText: {\n\t\tmarginStart: 20,\n\t\tmarginTop: 40,\n\t},\n\tresendCodeContainer: {\n\t\tflexDirection: 'row',\n\t\talignItems: 'center'\n\t}\n})\nexport default Verify\n"]},"metadata":{},"sourceType":"module"}